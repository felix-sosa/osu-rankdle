<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>OSU Rankdle</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Bootstrap Icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic" rel="stylesheet" type="text/css" />
        <!-- SimpleLightbox plugin CSS-->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.css" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Masthead-->
        <header class="masthead">
            <div class="row gx-4 gx-lg-5 h-100 justify-content-center text-center">
                <div>
                    <h1 class="text-white font-weight-bold">OSU Rankdle</h1>
                    <hr class="divider" />
                    <p class="text-white-75 mb-4">Guess the global ranking of the player in the clip!</p>
                    <label for="rankguess">Rank: </label>
                    <input type="number" min="1" max="999999999" id="rankguessinput">
                    <button onclick="submitFunc();">Submit</button><br><br>
                    <p id="results" style="display: none;" class="text-white-75">test (placeholder)</p>
                    <video width="700" height="525" controls>
                        <source src="assets/vid/sukisuki.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </header>
        <!-- Function to deal with getting user input -->
        <script>
            function submitFunc(){
                // Selecting the input element and get its value 
                var inputVal = document.getElementById("results").value;
                //Display result text
                var text = document.getElementById("results");
                text.style.display = "block";
            }
        </script>
        <!-- Function to get player profile link from google sheet and display once guess has been submitted -->
        <script>
            const googleSheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQNzxWLOwyQsZP0Acll26QlKH8KlENvFc7eVosEbKB_A6jbXPh0GHlOoVeg2baAG8JOVr7AsqeqhS6M/pub?output=csv';
        
            async function fetchData() {
                try {
                    const response = await fetch(googleSheetURL);
                    const csvData = await response.text();
        
                    // Parse CSV data into an array of objects
                    const rows = csvData.split('\n');
                    const headers = rows[0].split(',');
                    const jsonData = [];
        
                    for (let i = 1; i < rows.length; i++) {
                        const row = rows[i].split(',');
                        const rowData = {};
                        for (let j = 0; j < headers.length; j++) {
                            rowData[headers[j]] = row[j];
                        }
                        jsonData.push(rowData);
                    }
                    const url = jsonData[0].profile; // Replace with your actual URL
                    const linkText = "Profile"; // Replace with the text you want for the link

                    const linkElement = document.createElement("a");
                    linkElement.href = url;
                    linkElement.textContent = linkText;

                    const resultsElement = document.getElementById('results');
                    resultsElement.innerHTML = ''; // Clear the existing content
                    resultsElement.appendChild(linkElement);

        
                } catch (error) {
                    console.error('Error fetching data:', error);
                }
            }
        
            fetchData();
        </script>
              
        

        <footer>
            This website was created by Felix Sosa. Contact me on twitter <a href="https://twitter.com/fesoshima" target="_blank" rel="noopener noreferrer">here.</a> 
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- SimpleLightbox plugin JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <!-- * *                               SB Forms JS                               * *-->
        <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
    </body>
</html>
