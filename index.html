<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>OSU Rankdle</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Bootstrap Icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic" rel="stylesheet" type="text/css" />
        <!-- SimpleLightbox plugin CSS-->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.css" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Masthead-->
        <header class="masthead">
            <div class="row gx-4 gx-lg-5 h-100 justify-content-center text-center">
                <div>
                    <h1 class="text-white font-weight-bold">OSU Rankdle</h1>
                    <hr class="divider" />
                    <p class="text-white-75 mb-4">Guess the global ranking of the player in the clip!</p>
                    <label for="rankguess">Rank: </label>
                    <input type="number" min="1" max="999999999" id="rankguessinput">
                    <button onclick="submitFunc();">Submit</button><br><br>
                    <p id="results" style="display: none;" class="text-white-75"></p>
                    <video width="700" height="525" controls>
                        <source src="assets/vid/sukisuki.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </header>
        <!-- Function to deal with getting user input -->
        <script>
            function submitFunc(){
                // Selecting the input element and get its value 
                var inputVal = document.getElementById("results").value;
                //Display result text
                var text = document.getElementById("results");
                text.style.display = "block";
            }
        </script>
        <!-- Function to get player profile link from google sheet and display once guess has been submitted -->
        <script>
            async function displayProfileLink() {
                try {
                    // Fetch the Google Sheet data
                    const response = await fetch('https://docs.google.com/spreadsheets/d/1abZ6aA7VN6tkfVBCkPqWJLUFF5cF6lLoK-vnba0Tkhg/gviz/tq?tqx=out:json');
                    const data = await response.text();
         
                    // Parse the data
                    const json = JSON.parse(data.match(/google\.visualization\.Query\.setResponse\(([\s\S\w\d]*)\)/)[1]);
                    const row = json.table.rows[1]; // Assuming you want data from the second row (index 1)
         
                    // Get the <ul> element where data will be displayed
                    const ul = document.getElementById('profile-link');
         
                    // Populate the <ul> with data
                    if (row) {
                        const link = row.c[2].v; // Assuming the link is in the first column         
                        const li = document.createElement('li');
                        const a = document.createElement('a');
                        a.href = link;
                        li.appendChild(a);
                        ul.appendChild(li);
                    }
                } catch (error) {
                    console.error('Error fetching and displaying data:', error);
                }
            }
         
            // Call the function to display data when the page loads
            window.onload = displayProfileLink;
         </script>         
        

        <footer>
            This website was created by Felix Sosa. Contact me on twitter <a href="https://twitter.com/fesoshima" target="_blank" rel="noopener noreferrer">here.</a> 
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- SimpleLightbox plugin JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <!-- * *                               SB Forms JS                               * *-->
        <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
    </body>
</html>
